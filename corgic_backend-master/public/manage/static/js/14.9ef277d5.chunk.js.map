{"version":3,"sources":["utils/consts.js","utils/axiosInstance.js","pages/Blogs/Blogs.js"],"names":["msgStatus","UNREAD","READ","siteStatusLiteral","NORMAL","MAINTENANCE","LOCKDOWN","userStatus","PENDING","ACTIVE","DISABLED","S3_BASE","API_ROOT","instance","axios","create","baseURL","Blogs","auth","useContext","AuthContext","useState","blogs","setBlogs","activePage","setActivePage","pageCount","setPageCount","isDeleting","setIsDeleting","loaded","setLoaded","useEffect","a","offset","get","data","Math","floor","count","loadBlogs","deleteBlog","id","delete","headers","Authorization","admin","token","window","location","reload","toast","error","console","log","response","blogJSX","length","blogRows","map","blog","index","Row","key","Cell","width","as","image","Content","target","href","title","Subheader","position","size","content","moment","created_at","format","trigger","fromNow","style","marginRight","Link","to","primary","circular","icon","negative","onClick","loading","disabled","celled","stackable","Header","HeaderCell","Body","Footer","colSpan","firstItem","lastItem","prevItem","nextItem","totalPages","onPageChange","event","textAlign","active","className","dividing"],"mappings":"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","file":"static/js/14.9ef277d5.chunk.js","sourcesContent":["\r\nexport const msgStatus = {\r\n    UNREAD: 0,\r\n    READ: 1\r\n}\r\n\r\nexport const siteStatusLiteral = {\r\n    NORMAL: 1,\r\n    MAINTENANCE: 2,\r\n    LOCKDOWN: 3\r\n}\r\n\r\nexport const userStatus = {\r\n    PENDING: 0,\r\n    ACTIVE: 1,\r\n    DISABLED: 2\r\n}\r\n\r\nconst dev = \"http://localhost:5000/\";\r\nconst prod = \"https://thegospelpage.com/\";\r\n\r\nexport const S3_BASE = \"https://library-cdn.s3-us-west-1.amazonaws.com\";\r\n\r\nexport const API_ROOT = prod;","import axios from \"axios\";\r\nimport { API_ROOT } from \"./consts\";\r\n\r\nconst instance = axios.create({ baseURL: `${API_ROOT}api` });\r\n\r\nexport default instance;","import React, { useState, useContext, useEffect } from \"react\";\r\nimport { Header, Button, Pagination, Loader, Table, Popup } from \"semantic-ui-react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"../../utils/axiosInstance\";\r\nimport moment from \"moment\";\r\n\r\nimport { AuthContext } from \"../../shared/context/auth-context\";\r\n\r\nconst Blogs = () => {\r\n\r\n    const auth = useContext(AuthContext);\r\n\r\n    const [blogs, setBlogs] = useState(null);\r\n    const [activePage, setActivePage] = useState(0);\r\n    const [pageCount, setPageCount] = useState(null);\r\n    const [isDeleting, setIsDeleting] = useState(false);\r\n    const [loaded, setLoaded] = useState(false);\r\n\r\n    useEffect(() => {\r\n\r\n        async function loadBlogs() {\r\n\r\n            let offset = 0;\r\n\r\n            if (activePage !== 0 && activePage !== 1) {\r\n                offset = activePage * 15;\r\n            }\r\n\r\n            const { data } = await axios.get(`/blog/get-blogs/50/?offset=${offset}`);\r\n\r\n            setBlogs(data.blogs);\r\n            setPageCount(Math.floor(data.count / 15));\r\n            setLoaded(true);\r\n        }\r\n\r\n        loadBlogs();\r\n\r\n    }, [activePage]);\r\n\r\n    const handlePageChange = (event, { activePage }) => setActivePage(activePage);\r\n\r\n    const deleteBlog = async (id) => {\r\n\r\n        setIsDeleting(true);\r\n\r\n        try {\r\n\r\n            const { data } = await axios.delete(\r\n                `/admin/blog/${id}`,\r\n                { headers: { Authorization: `Bearer ${auth.admin.token}` } }\r\n            );\r\n\r\n            if (data) {\r\n                window.location.reload();\r\n            } else {\r\n                toast.error(\"Something went wrong, try again later!\");\r\n            }\r\n\r\n            setIsDeleting(false);\r\n            \r\n        } catch (err) {\r\n            console.log(err.response)\r\n        }\r\n    }\r\n\r\n    let blogJSX = null;\r\n\r\n    if (!loaded && !blogs) {\r\n\r\n        blogJSX = <Loader size=\"medium\" active />;\r\n\r\n    } else if (blogs.length > 0) {\r\n\r\n        let blogRows = blogs.map((blog, index) => {\r\n\r\n            return (\r\n                <Table.Row key={blog.id}>\r\n                    <Table.Cell width=\"12\">\r\n                        <Header as=\"h4\" image>\r\n                            <Header.Content as=\"a\" target=\"_blank\" href={`/`}>\r\n                                {blog.title}\r\n                                <Header.Subheader>\r\n                                    <Popup\r\n                                        position=\"bottom left\"\r\n                                        size=\"tiny\"\r\n                                        content={moment(blog.created_at).format(\"Do MMMM YYYY, h:mm a\")}\r\n                                        trigger={\r\n                                            <p>\r\n                                                Created {moment(blog.created_at).fromNow()}\r\n                                            </p>\r\n                                        }\r\n                                    />\r\n                                </Header.Subheader>\r\n                            </Header.Content>\r\n                        </Header>\r\n                    </Table.Cell>\r\n                    <Table.Cell width=\"4\">\r\n                        <Button \r\n                            title=\"Edit Blog\" \r\n                            style={{ marginRight: \"10px\" }}\r\n                            as={Link} \r\n                            to={`/new-blog/?edit=true&id=${blog.id}`} \r\n                            primary \r\n                            circular \r\n                            icon=\"edit\" \r\n                        />\r\n                        <Button \r\n                            title=\"Delete Blog\" \r\n                            negative \r\n                            circular \r\n                            icon=\"trash\" \r\n                            onClick={() => deleteBlog(blog.id)}\r\n                            loading={isDeleting}\r\n                            disabled={isDeleting}\r\n                        />\r\n                    </Table.Cell>\r\n                </Table.Row>\r\n            );\r\n        });\r\n\r\n        blogJSX = (\r\n            <Table celled stackable={false}>\r\n                <Table.Header>\r\n                    <Table.Row>\r\n                        <Table.HeaderCell>Title</Table.HeaderCell>\r\n                        <Table.HeaderCell>Action</Table.HeaderCell>\r\n                    </Table.Row>\r\n                </Table.Header>\r\n\r\n                <Table.Body>\r\n                    {blogRows}\r\n                </Table.Body>\r\n\r\n                {\r\n                    pageCount > 1 &&\r\n                    <Table.Footer>\r\n                        <Table.Row>\r\n                            <Table.HeaderCell colSpan=\"3\">\r\n                                <Pagination\r\n                                    firstItem={null}\r\n                                    lastItem={null}\r\n                                    prevItem={null}\r\n                                    nextItem={null}\r\n                                    activePage={activePage}\r\n                                    totalPages={pageCount}\r\n                                    onPageChange={handlePageChange}\r\n                                />\r\n                            </Table.HeaderCell>\r\n                        </Table.Row>\r\n                    </Table.Footer>\r\n                }\r\n            </Table>\r\n        );\r\n\r\n    } else {\r\n\r\n        blogJSX = (\r\n            <Header size=\"large\" textAlign=\"center\">\r\n                No stories have been created yet!\r\n            </Header>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"padded-content\">\r\n            <Header size=\"huge\" dividing>\r\n                Blogs\r\n            </Header>\r\n            {blogJSX}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Blogs;"],"sourceRoot":""}